<html>
<head>
	<title>Photophobia</title>
	<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5556515162447894"
     crossorigin="anonymous"></script>
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
<link rel="manifest" href="icons/site.webmanifest">
<link rel="mask-icon" href="icons/safari-pinned-tab.svg" color="#5bbad5">
<link rel="shortcut icon" href="icons/favicon.ico">
<meta name="msapplication-TileColor" content="#603cba">
<meta name="msapplication-config" content="icons/browserconfig.xml">
<meta name="theme-color" content="#ffffff">
	<meta charset="UTF-8">
	<meta property="og:type" content="website">
	<meta property="og:site_name" content="Photophobia">
	<meta property="og:title" content="Photophobia" />
	<meta name="twitter:card" content="summary_large_image">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://getbootstrap.com/docs/4.3/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.4.3/css/mdb.min.css">
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.7.0/css/all.css" integrity="sha384-lZN37f5QGtY3VHgisS14W3ExzMWZxybE1SJSEsQp9S+oqd12jhcu+A56Ebc1zFSJ"
	 crossorigin="anonymous">
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>
	<link rel="stylesheet" href="node_modules/xterm/css/xterm.css" />
	<script src="node_modules/xterm/lib/xterm.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
	<script src="js/disable.js"></script>
	<link rel="stylesheet" href="assets/style.css">
</head>
<style>
	.enter {
		box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);
        left:0px;
        right:0px;
		border: 0px solid black;
		font-size: 28px;
		color: white;
		font-weight: 200;
		font-family: "Roboto", sans-serif;
		overflow:auto;
		background-color: #171b1f;
        position:relative;
		transition: 0.3s;
		text-align: center;
	}
    a {
        color:inherit;
    }
    a:hover {
        color:inherit;
    }
	.enter:hover {
		background-color: #757575;
	}
    body {
  -webkit-touch-callout: none; 
  -webkit-user-select: none; 
   -khtml-user-select: none; 
     -moz-user-select: none; 
      -ms-user-select: none; 
         user-select: none; 
color: white;
overflow:auto;
background-color: #171b1f;
font-family: "Roboto", sans-serif;
font-weight: 500;

margin-top: 15vh;

}
hr {
  margin: 40px 0;
}
.hr3 {
  border: 0;
  height: 2px;
  background-image: linear-gradient(to right, transparent, rgb(95, 95, 95), transparent);  
}
</style>
<script>
window.onload = function() {
 await(5)
 sortTable(5)
}

function timeDifference(current, previous) {

    var msPerMinute = 60 * 1000;
    var msPerHour = msPerMinute * 60;
    var msPerDay = msPerHour * 24;
    var msPerMonth = msPerDay * 30;
    var msPerYear = msPerDay * 365;

    var elapsed = current - previous;

    if (elapsed < msPerMinute) {
         return Math.round(elapsed/1000) + ' seconds ago';   
    }

    else if (elapsed < msPerHour) {
         return Math.round(elapsed/msPerMinute) + ' minutes ago';   
    }

    else if (elapsed < msPerDay ) {
         return Math.round(elapsed/msPerHour ) + ' hours ago';   
    }

    else if (elapsed < msPerMonth) {
        return 'approximately ' + Math.round(elapsed/msPerDay) + ' days ago';   
    }

    else if (elapsed < msPerYear) {
        return 'approximately ' + Math.round(elapsed/msPerMonth) + ' months ago';   
    }

    else {
        return 'approximately ' + Math.round(elapsed/msPerYear ) + ' years ago';   
    }
}
fetch('https://api.github.com/repos/SSSEAL-C/photophobia/releases')
.then(function (response) {
	return response.json()
})
.then(function (json){
	json.forEach(function(json){
		assetsurl=json.assets_url
		url = json.html_url
		fetch(assetsurl)
		.then(function (response) {
		return response.json()
		})
		.then(function (json2){
			directdownload=json2[0].browser_download_url
			downloadcount=json.assets[0].download_count
			updatedat = json.assets[0].updated_at
			createdat = json.assets[0].created_at
			tag=json.tag_name
			var now = new Date()
			var updatedat = new Date(updatedat)
			var createdat = new Date(createdat)
			var timediff = timeDifference(now,updatedat)
			og = document.getElementById('versions').innerHTML
			console.log(og)
			var unix = Math.floor(createdat)
			document.getElementById('versions').innerHTML=og+'\n<tr>\n<td><p>'+tag+"</p></td>\n<td><p>"+downloadcount+"</td></p>\n<td><p>"+timediff+'</td></p>\n<td><p style="text-decoration:underline"><a href="'+directdownload+'" target="_blank" rel="noopener noreferrer">Link</a></p></td>\n<td><p style="text-decoration:underline"><a href="'+url+'" target="_blank" rel="noopener noreferrer">Link</a></p></td>\n<td><p hidden>'+unix+'</p></td></tr>'
		})
		.catch(function (error) {
			console.log("Error: " + error);
		});
	})
})
.catch(function (error) {
    console.log("Error: " + error);
  });
fetch("https://api.github.com/repos/SSSEAL-C/photophobia/releases/latest")
.then(function (response) {
	return response.json()
})
.then(function (json){
	url = json.html_url
	assetsurl=json.assets_url
	fetch(assetsurl)
	.then(function (response) {
	return response.json()
	})
	.then(function (json){
		directdownload=json[0].browser_download_url
		document.getElementById('download-button').href=directdownload
	})
	.catch(function (error) {
		console.log("Error: " + error);
	});
	downloadcount=json.assets[0].download_count
	updatedat = json.assets[0].updated_at
	tag=json.tag_name
	var now = new Date()
	var updatedat = new Date(updatedat)
	var timediff = timeDifference(now,updatedat)
	document.getElementById('release-button').href=url
	document.getElementById('current-version').innerHTML="Latest version is "+tag+' with '+downloadcount+' downloads.'
	document.getElementById('last-updated').innerHTML='Last updated '+timediff
})
.catch(function (error) {
    console.log("Error: " + error);
  });
  function sortTable(n) {
  var table, rows, switching, i, x, y, shouldSwitch, dir, switchcount = 0;
  table = document.getElementById("versionstable");
  switching = true;
  // Set the sorting direction to ascending:
  dir = "asc";
  /* Make a loop that will continue until
  no switching has been done: */
  while (switching) {
    // Start by saying: no switching is done:
    switching = false;
    rows = table.rows;
    /* Loop through all table rows (except the
    first, which contains table headers): */
    for (i = 1; i < (rows.length - 1); i++) {
      // Start by saying there should be no switching:
      shouldSwitch = false;
      /* Get the two elements you want to compare,
      one from current row and one from the next: */
      x = rows[i].getElementsByTagName("TD")[n];
      y = rows[i + 1].getElementsByTagName("TD")[n];
      /* Check if the two rows should switch place,
      based on the direction, asc or desc: */
      if (dir == "asc") {
        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
          // If so, mark as a switch and break the loop:
          shouldSwitch = true;
          break;
        }
      } else if (dir == "desc") {
        if (x.innerHTML.toLowerCase() < y.innerHTML.toLowerCase()) {
          // If so, mark as a switch and break the loop:
          shouldSwitch = true;
          break;
        }
      }
    }
    if (shouldSwitch) {
      /* If a switch has been marked, make the switch
      and mark that a switch has been done: */
      rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
      switching = true;
      // Each time a switch is done, increase this count by 1:
      switchcount ++;
    } else {
      /* If no switching has been done AND the direction is "asc",
      set the direction to "desc" and run the while loop again. */
      if (switchcount == 0 && dir == "asc") {
        dir = "desc";
        switching = true;
      }
    }
  }
}
</script>
</head>
<div class="topnav">
	<a href="../">Home</a> 
	<a href="../guide">Setup Guide</a>
	<a href="./" class="active">Downloads</a> 
</div>
<body>
	<div id="soundtrack"></div>
	<div class="container mt-3 text-center" style="overflow:hidden;box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 20px 0 rgba(0, 0, 0, 0.19);">
		<h1 class="lo" , style="font-weight:400;padding-top:40px" class="featurette-heading">Latest Download</h1>
		<h3 style="padding-top:20px"></h3>
		<h3 class="lo" id="current-version"></h3>
		<p class="lo" id="last-updated">This datapack works for multiplayer and singleplayer.</p>
		<h3 style="padding-bottom:15px"></h3>
		<div>
			<button class="enter"><a id="download-button" href="" target="_blank" rel="noopener noreferrer">Download</a></button>
		</div>
		<h3 style="padding-bottom:25px"></h3>
		<div>
			<button class="enter"><a id="release-button" href="" target="_blank" rel="noopener noreferrer">View Files</a></button>
		</div>
		<h3 style="padding-bottom: 20px;"></h3>
		<hr class="hr3">
		<h2 class="lo" style="font-weight:400;">Versions</h2>
		<h3 class="lo" style="font-size:20px">Click the table if it isnt sorting correctly.</h3>
		<table onclick="sortTable(5)"id="versionstable" style="display:inline;">
			<tbody id="versions">
				<tr>
					<td><p>Version</p></td>
					<td><p>Downloads</p></td>
					<td><p>Last Updated</p></td>
					<td><p>Direct Download</p></td>
					<td><p>View Files</p></td>
					<td><p hidden>Originally Created</p></td>
				</tr>
			</tbody>
		</table>
		<h3 style="padding-bottom:40px;"></h3>
		<h3 style="text-align:center;font-size:10px">Original Code by <a href="https://github.com/SSSEAL-C/hydrophobia" style="font-size:10px"target="_blank" rel="noopener noreferrer" class="enter">Seal</a></h3>
		<h3 style="padding-bottom:40px"></h3>
	</div>
	<h3 style="padding-bottom:5px"></h3>
    <h3 style="text-align:center;font-size:10px">This website was maintained and redesigned by <a href="https://ssseal-c.github.io/website-idea" style="font-size:10px"target="_blank" rel="noopener noreferrer" class="enter">Seal</a></h3>
</body>
</html>
